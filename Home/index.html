<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com/3.4.1"></script>
    <title>Options & Company</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="shortcut icon" href="./../images/logo.png" type="image/x-icon" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Playfair+Display:wght@700&display=swap"
      rel="stylesheet"
    />

<style>
  /* Scrollbar (WebKit) */
  ::-webkit-scrollbar{width:10px;height:10px}
  ::-webkit-scrollbar-track{background:#1a1a1a}
  ::-webkit-scrollbar-thumb{background:#418d75;border-radius:6px}
  ::-webkit-scrollbar-thumb:hover{background:#2e6b56}

  /* Reset + Firefox scrollbar */
  *{
    margin:0;padding:0;box-sizing:border-box;
    scrollbar-width:thin;scrollbar-color:#418d75 #1a1a1a
  }

  html,body{overflow-x:hidden}
  body{
    --bg-image:url("images/");
    font-family:"Inter",sans-serif;background-color:#0f2a29;color:#fff;
    position:relative;min-height:100vh
  }
  .font-logo{font-family:serif}
  .e-comercial{color:#4ea788}

  /* Fundo grade leve */
  body::before{
    content:"";position:fixed;inset:0;z-index:0;pointer-events:none;
    background-image:
      linear-gradient(135deg,rgba(255,255,255,.03) 1px,transparent 1px),
      linear-gradient(225deg,rgba(255,255,255,.03) 1px,transparent 1px);
    background-size:30px 30px
  }
  body::after{content:none}

  .background-text{position:absolute;top:0;right:0;margin:-2rem -3rem 0 0;user-select:none;z-index:0}
  .background-text span{
    font-family:"Playfair Display",serif;font-size:20vw;font-weight:700;
    color:rgba(255,255,255,.05);transform:rotate(-12deg);display:inline-block
  }

  .container{
    position:relative;z-index:1;min-height:100vh;display:flex;flex-direction:column;
    max-width:1280px;margin:0 auto;padding:0 1rem
  }

  .header{width:100%;padding-top:1rem;position:relative;margin-bottom:0}
  .header-content{
    position:absolute;display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:nowrap;
    border-bottom:1px solid rgba(255,255,255,.1);padding:10px 20px 16px;min-height:72px;
    background:rgba(0,0,0,.15);backdrop-filter:saturate(120%) blur(2px);border-radius:12px; z-index: 60; width: 100%;
  }
  .top-left{display:flex;gap:16px;align-items:center;flex:1 1 auto;z-index:100;order:1}
  .menu-btn{
    border:1px solid rgba(255,255,255,.5);background:transparent;color:#fff;border-radius:.375rem;
    padding:.375rem 1rem;font-size:.875rem;cursor:pointer;transition:background-color .2s
  }
  .menu-btn:hover{background-color:rgba(255,255,255,.1)}

  /* Ferramentas (Google-style) */
  .google-tools{
    position:relative;display:flex;align-items:center;gap:.25rem;font-size:.75rem;margin-left:auto
  }
  .google-tools>button{
    background:#fff;color:#000;font-weight:700;border:0;border-radius:.375rem;
    padding:.375rem .75rem;cursor:pointer;transition:background-color .2s
  }
  .google-tools>button:hover{background:#e5e5e5}
  .google-tools>button.apps-btn{
    width:40px;height:40px;background:transparent;color:#fff;border:0;border-radius:8px;
    display:grid;place-items:center;padding:0;cursor:pointer;transition:background-color .2s,transform .06s
  }
  .google-tools>button.apps-btn:hover{background:rgba(255,255,255,.1)}
  .google-tools>button.apps-btn:active{transform:translateY(1px)}
  .google-tools>button.apps-btn:focus-visible{outline:2px solid rgba(255,255,255,.6);outline-offset:2px}

  /* Dropdown estilo Google */
  .dropdown-content{
    display:absolute;position:absolute;right:0;top:100%;margin-top:8px;z-index:60;pointer-events:none;overflow:hidden;
    background:#dfdfdf;min-width:320px;border-radius:12px;padding:12px;
    box-shadow:0 12px 28px rgba(0,0,0,.3);opacity:0;transform:translateY(-8px) scale(.98);
    transition:opacity .18s ease,transform .18s ease;
  }
  .dropdown-content.show{display:block;opacity:1;transform:translateY(0) scale(1);pointer-events:auto; z-index: 60;}
  .app-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px;max-height:420px;overflow:auto}
  .app{
    display:flex;flex-direction:column;align-items:center;gap:8px;padding:12px 8px;
    text-decoration:none;border-radius:12px;color:#000;outline:none
  }
  .app img{width:32px;height:32px;border-radius:8px;display:block}
  .app span{
    font-size:12px;line-height:1.2;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%
  }
  .app:hover,.app:focus-visible{background:rgba(255,255,255,.08)}
  @media (max-width:420px){
    .dropdown-content{min-width:280px}
    .app-grid{grid-template-columns:repeat(4,1fr)}
  }

  /* “Página inicial” estilo Google */
  .google-hero{flex:1;display:grid;place-items:center;padding:6vh 1rem 8vh}
  .hero-inner{width:100%;max-width:640px;display:flex;flex-direction:column;align-items:center;gap:24px;text-align:center}
  .hero-logo{max-width:min(60vw,300px);height:auto;filter:drop-shadow(0 2px 10px rgba(0,0,0,.35))}

  .site-search{
    position:static;transform:none;display:flex;align-items:center;gap:8px;z-index:4;flex:0 0 auto;width:100%;justify-content:center
  }
  .search-wrap{position:relative;flex:1}
  .search-wrap .search-icon{
    position:absolute;left:12px;top:50%;transform:translateY(-50%);width:18px;height:18px;opacity:.9;pointer-events:none;z-index:2
  }
  .site-search input[type="search"]{
    width:100%;padding:12px 14px 12px 40px;border:1px solid rgba(255,255,255,.18);
    background:rgba(0,0,0,.28);color:#fff;border-radius:999px;outline:none;backdrop-filter:blur(4px)
  }
  .site-search input[type="search"]::placeholder{color:rgba(255,255,255,.7)}
  .site-search button[type="submit"]{
    padding:12px 18px;border-radius:999px;border:0;background:#418d75;color:#fff;font-weight:600;cursor:pointer;white-space:nowrap
  }

  /* Sugestões */
  .suggest-panel{
    position:absolute;top:calc(100% + 6px);left:0;right:0;z-index:50;background:#232323;
    border:1px solid rgba(255,255,255,.12);border-radius:12px;box-shadow:0 18px 40px rgba(0,0,0,.38);
    padding:6px;max-height:min(50vh,420px);overflow:auto
  }
  .suggest-empty{padding:10px 12px;color:rgba(255,255,255,.7);font-size:14px}
  .suggest-item{
    display:grid;grid-template-columns:28px 1fr auto auto;align-items:center;gap:10px;
    padding:8px 10px;border-radius:8px;cursor:pointer
  }
  .suggest-item:hover,.suggest-item[aria-selected="true"]{background:rgba(255,255,255,.08)}
  .suggest-icon{width:18px;height:18px;border-radius:4px;display:inline-block;background:rgba(255,255,255,.12)}
  .suggest-text{display:flex;flex-direction:column;min-width:0}
  .suggest-primary{
    color:#fff;font-size:14px;line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis
  }
  .suggest-secondary{
    color:rgba(255,255,255,.65);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:2px
  }
  .suggest-badge{
    font-size:11px;padding:3px 6px;border-radius:999px;background:rgba(65,141,117,.18);
    color:#a6e0cf;border:1px solid rgba(65,141,117,.35);margin-left:8px
  }
  .suggest-remove{font-size:16px;line-height:1;padding:2px 6px;color:rgba(255,255,255,.65);cursor:pointer;user-select:none}
  .suggest-remove:hover{color:#ff6b6b}

  .header-titles-desktop{display:none!important}
  .main-content{display:none}
  .tab-panel{display:none;width:100%}
  .tab-panel.active{display:block}

  /* Sidebar */
  .sidebar{
    position:fixed;inset:0 0 0 auto;width:min(82vw,360px);transform:translateX(100%);
    background:#0f2a29;color:#fff;padding:16px;box-shadow:-2px 0 8px rgba(0,0,0,.35);
    transition:transform .3s ease;z-index:1000;border-left:1px solid rgba(255,255,255,.1);backdrop-filter:saturate(120%)
  }
  .sidebar.is-open{transform:translateX(0)}
  .sidebar-header{
    display:flex;align-items:center;justify-content:space-between;gap:1rem;
    border-bottom:1px solid rgba(255,255,255,.12);padding-bottom:.5rem;margin-bottom:.75rem
  }
  .sidebar-header h2{margin:0;font-size:1.2rem}
  .close-btn{
    background:transparent;color:#fff;border:none;font-size:1.8rem;line-height:1;cursor:pointer;border-radius:8px;padding:.2rem .4rem
  }
  .close-btn:hover{background:rgba(255,255,255,.08)}
  .sidebar-links{display:flex;flex-direction:column;gap:.25rem}
  .sidebar-links a{color:#fff;text-decoration:none;padding:.65rem .6rem;border-radius:8px}
  .sidebar-links a:hover{background:#123c38;color:#d1fae5}
  .overlay{
    position:fixed;inset:0;background:rgba(0,0,0,.45);opacity:0;visibility:hidden;transition:.25s ease;z-index:999
  }
  .overlay.is-open{opacity:1;visibility:visible}

  /* Imagem única Home (oculta) */
  .tab-media-wrap{
    width:100%;height:95vh;border-radius:12px;overflow:hidden;margin:8px 0 16px;
    background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.15);display:none
  }
  .tab-media-wrap img{width:100%;height:800px;display:block;object-fit:cover}

  /* Responsivo */
  @media (max-width:640px){
    .header-content{flex-wrap:wrap;gap:8px 12px;padding:8px 12px}
    .top-left{order:1}
    .hero-logo{max-width:68vw}
  }

  /* Modal (popup central) */
  .menu-modal{position:fixed;inset:0;display:grid;place-items:center;z-index:1100;visibility:hidden}
  .menu-modal.is-open{visibility:visible}
  .menu-modal .overlay-blur{
    position:absolute;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(4px) saturate(110%);
    opacity:0;transition:opacity .22s ease
  }
  .menu-modal.is-open .overlay-blur{opacity:1}
  .menu-card{
    position:relative;width:min(92vw,560px);border-radius:16px;padding:18px;
    background:radial-gradient(1200px 400px at 10% -20%,rgba(78,167,136,.12),transparent 60%),rgba(20,48,47,.92);
    border:1px solid rgba(255,255,255,.12);box-shadow:0 18px 60px rgba(0,0,0,.45);
    transform:translateY(8px) scale(.96);opacity:0;
    transition:transform .26s cubic-bezier(.2,.8,.2,1),opacity .2s ease
  }
  .menu-modal.is-open .menu-card{transform:translateY(0) scale(1);opacity:1}
  .menu-header{
    display:flex;align-items:center;justify-content:space-between;gap:12px;padding:6px 8px 12px;
    border-bottom:1px solid rgba(255,255,255,.08);margin-bottom:8px
  }
  .menu-title{font-size:1.125rem;font-weight:700;letter-spacing:.2px}
  .menu-close{
    background:transparent;color:#fff;border:0;font-size:1.6rem;line-height:1;cursor:pointer;border-radius:10px;padding:2px 8px
  }
  .menu-close:hover{background:rgba(255,255,255,.08)}
  .menu-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;padding-top:10px}
  @media (max-width:560px){.menu-grid{grid-template-columns:1fr}}
  .menu-item{
    display:flex;align-items:center;gap:12px;padding:12px;border-radius:12px;text-decoration:none;color:#eaf6f2;
    background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);
    transition:transform .12s ease,background .2s ease,border-color .2s ease
  }
  .menu-item:hover{background:rgba(65,141,117,.12);border-color:rgba(65,141,117,.35);transform:translateY(-1px)}
  .menu-item-icon{
    width:36px;height:36px;border-radius:10px;display:grid;place-items:center;
    background:rgba(65,141,117,.18);border:1px solid rgba(65,141,117,.35)
  }
  .menu-item-title{font-weight:600}
  .menu-item-sub{font-size:.85rem;opacity:.8}
  @media (prefers-reduced-motion:reduce){
    .menu-card,.menu-modal .overlay-blur{transition:none}
  }

  /* Vídeo de fundo */
  #video-bg.video-bg{
    position:fixed;inset:0;width:100%;height:100%;object-fit:cover;object-position:center;z-index:-2;
    filter:brightness(.5);pointer-events:none;background:#0f2a29
  }

  /* Atalhos rápidos */
  .quick-shortcuts{width:100%;max-width:640px;margin-top:10px}
  .chip-row{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;align-items:center;padding:4px;overflow-x:auto}
  .shortcut-chip{
    position:relative;display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;text-decoration:none;color:#fff;
    background:rgba(0,0,0,.28);border:1px solid rgba(255,255,255,.14);backdrop-filter:blur(4px);
    transition:background .2s,transform .06s,border-color .2s
  }
  .shortcut-chip:hover{background:rgba(255,255,255,.1);border-color:rgba(255,255,255,.22)}
  .shortcut-chip:active{transform:translateY(1px)}
  .shortcut-chip img{width:18px;height:18px;border-radius:4px;display:block}
  .shortcut-add{font-weight:700;border-style:dashed;border-color:rgba(255,255,255,.22);cursor:pointer}
  .shortcut-chip button[type="button"]{opacity:0;transition:opacity .15s}
  .shortcut-chip:hover button[type="button"]{opacity:1}

  @media (prefers-reduced-motion:reduce){#video-bg.video-bg{display:none}}

  .notice-overlay {
    position: fixed; inset: 0;
    background: color-mix(in srgb, var(--bg-0, #000) 65%, transparent);
    background: var(--overlay-fallback, #000000a6);
    backdrop-filter: blur(2px);
    z-index: 9998;
  }

  .notice-modal {
    position: fixed; inset: 0; margin: auto;
    width: min(92vw, 720px); max-height: min(92vh, 90dvh);
    overflow: hidden; display: grid; grid-template-rows: auto 1fr;
    background: var(--card, #0c1512); color: var(--text, #e6f6ef);
    border: 1px solid color-mix(in srgb, var(--ring, #00ffa3) 16%, transparent);
    border-radius: var(--radius, 16px);
    box-shadow: var(--shadow-1, 0 10px 30px rgba(0, 0, 0, 0.35)), var(--shadow-2, 0 2px 10px rgba(0, 0, 0, 0.25));
    z-index: 9999; font-family: inherit;
    transform: translateY(8px) scale(0.98);
    opacity: 0; pointer-events: none; isolation: isolate;
  }
  .notice-modal[data-open="true"] {
    opacity: 1; transform: translateY(0) scale(1); pointer-events: auto;
    transition: opacity .2s ease, transform .25s cubic-bezier(.2,.8,.2,1);
  }

  .notice-close {
    position: absolute; top: .75rem; right: .75rem;
    display: grid; place-items: center; width: 36px; height: 36px;
    border-radius: 999px;
    border: 1px solid color-mix(in srgb, var(--ring, #00ffa3) 24%, transparent);
    background: var(--bg-2, #0a0f0d); color: var(--muted, #a7c7bb);
    box-shadow: var(--shadow-1, 0 10px 30px rgba(0,0,0,.35));
    cursor: pointer; transition: transform .15s ease, opacity .15s ease, background .15s ease, color .15s ease, border-color .15s ease;
    z-index: 10; pointer-events: auto;
  }
  .notice-close:hover { transform: scale(1.06); color: var(--text, #e6f6ef); }
  .notice-close:focus-visible {
    outline: none; box-shadow: 0 0 0 3px color-mix(in srgb, var(--ring, #00ffa3) 35%, transparent);
  }

  .notice-media {
    background: var(--bg-1, #0e1a16);
    border-bottom: 1px solid color-mix(in srgb, var(--ring, #00ffa3) 12%, transparent);
    aspect-ratio: 16/9; overflow: hidden;
  }
  .notice-media img { width: 100%; height: 100%; object-fit: cover; display: block; filter: saturate(1.05) contrast(1.02); }

  .notice-content {
    padding: clamp(1rem, 2.5vw, 1.25rem) clamp(1rem, 3vw, 1.5rem) 1.25rem;
    display: grid; gap: .75rem;
    background: linear-gradient(180deg,
      color-mix(in srgb, var(--card, #0c1512) 100%, transparent) 0%,
      color-mix(in srgb, var(--card-2, #0b130f) 100%, transparent) 100%);
  }
  .notice-content h2 { margin: 0; line-height: 1.15; font-size: clamp(1.15rem, 2.2vw, 1.5rem); letter-spacing: .2px; }
  .notice-content p  { margin: 0; color: var(--muted, #a7c7bb); font-size: clamp(.95rem, 1.8vw, 1rem); }

  .notice-actions { margin-top: .25rem; display: flex; gap: .5rem; flex-wrap: wrap; align-items: center; }
  .notice-cta {
    display: inline-flex; align-items: center; justify-content: center; gap: .5rem;
    padding: .6rem .9rem; border-radius: calc(var(--radius, 16px) - 8px);
    font-weight: 600; text-decoration: none; color: var(--bg-0, #000);
    background: linear-gradient(180deg,
      color-mix(in srgb, var(--brand, #00ffa3) 92%, transparent) 0%,
      color-mix(in srgb, var(--brand, #00ffa3) 80%, transparent) 100%);
    border: 1px solid color-mix(in srgb, var(--ring, #00ffa3) 35%, transparent);
    box-shadow: var(--shadow-2, 0 2px 10px rgba(0,0,0,.25));
    transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
  }
  .notice-cta:hover { transform: translateY(-1px); filter: saturate(1.05); }

  @media (prefers-reduced-motion: reduce) {
    .notice-modal, .notice-close, .notice-cta { transition: none !important; }
  }

  /* Estilos do Chat Widget */
  #chat-widget-button {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background-color: #418d75;
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    border: none;
    display: none/*flex*/;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    z-index: 1050;
    transition: transform 0.2s ease;
  }
  #chat-widget-button:hover {
    transform: scale(1.1);
  }

  #chat-widget-container {
    position: fixed;
    bottom: calc(2rem + 70px);
    right: 2rem;
    width: min(90vw, 380px);
    height: 70vh;
    max-height: 600px;
    background-color: #1a1a1a;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.35);
    z-index: 1040;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: all 0.3s ease;
    transform-origin: bottom right;
  }

  #chat-widget-container.hidden {
      opacity: 0;
      transform: scale(0.9) translateY(10px);
      pointer-events: none;
  }

  #chat-widget-container.expanded {
    width: 80vw;
    height: 80vh;
    max-width: 1200px;
    max-height: 90vh;
    bottom: 50%;
    right: 50%;
    transform: translate(50%, 50%);
  }

  .chat-header {
    background-color: #2e6b56;
    color: white;
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: bold;
    border-bottom: 1px solid #418d75;
    flex-shrink: 0;
  }

  .chat-header-title {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .chat-header-logo {
    width: 30px;
    height: 30px;
    border-radius: 4px;
  }

  .chat-header-controls {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  #chat-expand-btn,
  #chat-close-btn {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    line-height: 1;
    padding: 0.2rem;
  }
    #chat-expand-btn {
      font-size: 1.1rem;
    }
  #chat-close-btn {
    font-size: 1.5rem;
  }


  .chat-messages {
    flex-grow: 1;
    overflow-y: auto;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .chat-message {
    padding: 0.75rem 1rem;
    border-radius: 12px;
    max-width: 80%;
    line-height: 1.4;
  }

  .user-message {
    background-color: #418d75;
    color: white;
    align-self: flex-end;
    border-bottom-right-radius: 4px;
  }

  .model-message {
    background-color: #333;
    color: #f1f1f1;
    align-self: flex-start;
    border-bottom-left-radius: 4px;
  }
  
  .loading-indicator {
      align-self: flex-start;
  }
  .loading-indicator span {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: #777;
      animation: bounce 1.4s infinite ease-in-out both;
  }
  .loading-indicator span:nth-child(1) { animation-delay: -0.32s; }
  .loading-indicator span:nth-child(2) { animation-delay: -0.16s; }
  @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1.0); }
  }


  .chat-form {
    display: flex;
    padding: 1rem;
    border-top: 1px solid #333;
    gap: 0.5rem;
    flex-shrink: 0;
  }

  #chat-input {
    flex-grow: 1;
    padding: 0.75rem;
    border: 1px solid #444;
    background-color: #222;
    color: white;
    border-radius: 999px;
    outline: none;
  }
  #chat-input:focus {
    border-color: #418d75;
  }

  #chat-send-btn {
    background-color: #418d75;
    border: none;
    color: white;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    flex-shrink: 0;
  }

</style>

<style>
  html.auth-checking{visibility:hidden}
</style>

  </head>
<body>
  <video id="video-bg" class="video-bg" autoplay muted loop playsinline poster="./../images/video-bg.mp4">
    <source src="./../images/video-bg.mp4" type="video/mp4">Seu navegador não suporta vídeo em HTML5.
  </video>

  <div class="container">
    <header class="header">
      <div class="header-content">
        <div class="top-left">
          <button class="menu-btn" id="menu-toggle" aria-expanded="false" aria-controls="sidebar">Menu</button>
          <div class="google-tools">
            <span id="welcomeUser" style="margin-left:12px;font-weight:700"></span>
            <button id="google-button" class="apps-btn z50" aria-controls="google-dropdown" aria-expanded="false" aria-label="Abrir aplicativos">
              <svg width="20" height="20" viewBox="0 0 20 20" aria-hidden="true"><g fill="currentColor"><circle cx="4" cy="4" r="1.5"/><circle cx="10" cy="4" r="1.5"/><circle cx="16" cy="4" r="1.5"/><circle cx="4" cy="10" r="1.5"/><circle cx="10" cy="10" r="1.5"/><circle cx="16" cy="10" r="1.5"/><circle cx="4" cy="16" r="1.5"/><circle cx="10" cy="16" r="1.5"/><circle cx="16" cy="16" r="1.5"/></g></svg>
            </button>
            <div id="google-dropdown" class="dropdown-content" role="menu" aria-hidden="true">
              <div class="app-grid" role="list">
                <a class="app" href="https://www.google.com" rel="noopener" role="menuitem"><img src="./../images/favicon_google.ico" alt=""><span>Home</span></a>
                <a class="app" href="https://calendar.google.com" rel="noopener" role="menuitem"><img src="./../images/favicon_calendar.ico" alt=""><span>Agenda</span></a>
                <a class="app" href="https://mail.google.com" rel="noopener" role="menuitem"><img src="./../images/favicon_gmail.ico" alt=""><span>Gmail</span></a>
                <a class="app" href="https://docs.google.com/spreadsheets/" rel="noopener" role="menuitem"><img src="./../images/favicon_sheets.ico" alt=""><span>Planilhas</span></a>
                <a class="app" href="https://meet.google.com" rel="noopener" role="menuitem"><img src="./../images/favicon_meet.ico" alt=""><span>Meet</span></a>
                <a class="app" href="https://docs.google.com/document/" rel="noopener" role="menuitem"><img src="./../images/docs.ico" alt=""><span>Docs</span></a>
                <a class="app" href="https://chat.google.com/" rel="noopener" role="menuitem"><img src="./../images/chat.ico" alt=""><span>Chat</span></a>
                <a class="app" href="https://www.youtube.com/" rel="noopener" role="menuitem"><img src="./../images/youtube.ico" alt=""><span>YouTube</span></a>
                <a class="app" href="https://chatgpt.com/" rel="noopener" role="menuitem"><img src="./../images/favicon_chagpt.ico" alt=""><span>ChatGPT</span></a>
                <a class="app" href="https://gemini.google.com/" rel="noopener" role="menuitem"><img src="./../images/gemini.ico" alt=""><span>Gemini</span></a>
                <a class="app" href="https://plataformafasttrade.com.br/"rel="noopener" role="menuitem"><img src="./../images/fast_trade.ico" alt=""><span>Fast Trade</span></a>
                <a class="app" href="https://drive.google.com" rel="noopener" role="menuitem"><img src="./../images/drive.ico" alt=""><span>Drive</span></a>
                <a class="app" href="https://web.whatsapp.com/" rel="noopener" role="menuitem"><img src="./../images/WhatsApp-icon.png" alt=""><span>WhatsApp</span></a>
                <a class="app" href="https://www.linkedin.com/login/pt?fromSignIn=true&trk=guest_homepage-basic_nav-header-signin" rel="noopener" role="menuitem"><img src="./../images/linkedin.ico" alt=""><span>LinkedIn</span></a>
              </div>
            </div>
          </div>
        </div>

        <div id="fav-grid" class="app-grid" role="list"></div>
        <template id="fav-add-card"><button class="app" type="button" data-open-fav-modal><div style="width:32px;height:32px;border-radius:8px;background:#0b5;display:grid;place-items:center;color:#fff;font-weight:900">+</div><span>Atalho</span></button></template>
        <div class="header-titles-desktop" aria-hidden="true"><img src="./../images/logo_texto_recortado.png" alt="Logo Options & Company" class="logo"></div>
      </div>
    </header>

    <div id="menu-modal" class="menu-modal" aria-hidden="true">
      <div class="overlay-blur" data-close-modal></div>
      <div class="menu-card" role="dialog" aria-modal="true" aria-labelledby="menu-modal-title">
        <div class="menu-header"><h2 id="menu-modal-title" class="menu-title">Opções</h2><button class="menu-close" type="button" aria-label="Fechar" data-close-modal>×</button></div>
        <nav class="menu-grid">
          <a class="menu-item" href="#home" data-tab-target="home"><div class="menu-item-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 10.5 12 4l8 6.5V20a1 1 0 0 1-1 1h-5v-6H10v6H5a1 1 0 0 1-1-1v-9.5Z" stroke="currentColor" stroke-width="1.5"/></svg></div><div><div class="menu-item-title">Início</div><div class="menu-item-sub">Voltar para a tela principal</div></div></a>
          <!-- <a class="menu-item" href="https://indicadoresmesaco.netlify.app/" rel="noopener"><div class="menu-item-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 13v7h4v-7H4Zm6-6v13h4V7h-4Zm6 3v10h4V10h-4Z" stroke="currentColor" stroke-width="1.5"/></svg></div><div><div class="menu-item-title">Indicadores</div><div class="menu-item-sub">Looker Studio</div></div></a> -->
          <a class="menu-item" href="https://chamadoadm.netlify.app" rel="noopener"><div class="menu-item-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 3v6m0 12a9 9 0 1 0-9-9h9v9Z" stroke="currentColor" stroke-width="1.5"/></svg></div><div><div class="menu-item-title">Suporte</div><div class="menu-item-sub">Abrir chamado de TI</div></div></a>
          <a class="menu-item" href="./../login.html" rel="noopener"><div class="menu-item-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4 0-7 2-7 5v1h14v-1c0-3-3-5-7-5Z" stroke="currentColor" stroke-width="1.5"/></svg></div><div><div class="menu-item-title">Liderança</div><div class="menu-item-sub">Área restrita</div></div></a>
          <a class="menu-item" href="https://bibliotecaco.netlify.app/" rel="noopener"><div class="menu-item-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 7h16M7 4h10a1 1 0 0 1 1 1v14l-6-3-6 3V5a1 1 0 0 1 1-1Z" stroke="currentColor" stroke-width="1.5"/></svg></div><div><div class="menu-item-title">Biblioteca</div><div class="menu-item-sub">Documentos e materiais</div></div></a>
          <a class="menu-item" href="./../beneficios" rel="noopener"><div class="menu-item-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 7h16M7 4h10a1 1 0 0 1 1 1v14l-6-3-6 3V5a1 1 0 0 1 1-1Z" stroke="currentColor" stroke-width="1.5"/></svg></div><div><div class="menu-item-title">Benefícios</div><div class="menu-item-sub">Guias e políticas</div></div></a>
          <a class="menu-item" href="./../embreve/"rel="noopener"><div class="menu-item-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 7h16M7 4h10a1 1 0 0 1 1 1v14l-6-3-6 3V5a1 1 0 0 1 1-1Z" stroke="currentColor" stroke-width="1.5"/></svg></div><div><div class="menu-item-title">Cursos</div><div class="menu-item-sub">Cursos da options</div></div></a>
        </nav>
      </div>
    </div>

    <section class="google-hero" role="region" aria-label="Página inicial">
      <div class="hero-inner">
        <img class="hero-logo" src="./../images/logo_texto_recortado.png" alt="Options & Company">
        <form class="site-search" role="search" aria-label="Pesquisar na web" action="https://www.google.com/search" method="GET" target="_self" id="search-form">
          <div class="search-wrap">
            <img src="./../images/favicon_google.ico" alt="" class="search-icon" aria-hidden="true">
            <input id="q" name="q" type="search" placeholder="Pesquisar no Google…" autocomplete="off" inputmode="search" spellcheck="false" aria-controls="suggestions">
            <div id="suggestions" class="suggest-panel" role="listbox" aria-label="Sugestões" hidden></div>
          </div>
          <button type="submit" aria-label="Pesquisar">Buscar</button>
        </form>
        <nav id="quick-shortcuts" class="quick-shortcuts" aria-label="Atalhos rápidos"><div id="quick-chip-row" class="chip-row" role="list"></div></nav>
      </div>
    </section>

    <main class="main-content" id="tab-root" role="region" aria-live="polite">
      <section id="tab-home" class="tab-panel active" role="tabpanel" aria-labelledby="tablink-home">
        <div class="tab-media-wrap"><img src="./../images/WhatsApp Image 2025-09-15 at 08.42.39.jpeg" alt="Mesa de operação - Options & Company" loading="eager" fetchpriority="high"></div>
      </section>
<!--      <section id="tab-indicadores" class="tab-panel" role="tabpanel" aria-labelledby="tablink-indicadores">
        <div class="frame-wrap"><iframe title="Dashboard Looker Studio" src="https://indicadoresmesaco.netlify.app/" style="width:100%;height:70vh;border:0" sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe></div>
      </section> -->
    </main>
  </div>

  <aside class="sidebar" id="sidebar" aria-hidden="true">
    <div class="sidebar-header"><h2>Menu</h2><button class="close-btn" id="close-sidebar" aria-label="Fechar menu">×</button></div>
    <nav class="sidebar-links">
      <a href="#home" id="tablink-home" data-tab-target="home" aria-controls="tab-home">Início</a>
      <a id="link-biblioteca" href="https://bibliotecaco.netlify.app/" target="_blank" rel="noopener">Biblioteca</a>
      <!-- <a href="https://indicadoresmesaco.netlify.app/" id="link-indicadores" target="_blank" rel="noopener">Indicadores</a> -->
      <a href="https://chamadoadm.netlify.app" id="link-chamado-ti" rel="noopener">Suporte</a>
      <a id="link-website" href="login.html" rel="noopener">Liderança</a>
      <a id="link-beneficios" href="./../beneficios" rel="noopener">Beneficios</a>
    </nav>
  </aside>
  <div class="overlay" id="overlay" hidden></div>

  <!-- Modal Favoritos -->
  <div id="fav-modal" class="menu-modal" aria-hidden="true">
    <div class="overlay-blur" data-close-fav></div>
    <div class="menu-card" role="dialog" aria-modal="true" aria-labelledby="fav-modal-title">
      <div class="menu-header">
        <h2 id="fav-modal-title" class="menu-title">Atalho</h2>
        <button class="menu-close" type="button" aria-label="Fechar" data-close-fav>×</button>
      </div>
      <div style="display:grid;gap:10px;padding:10px 6px">
        <label style="display:grid;gap:6px"><span>Nome</span><input id="fav-name" type="text" placeholder="Ex.: Planilhas" style="padding:10px;border-radius:10px;border:1px solid #ccc;background:#fff;color:#111"/></label>
        <label style="display:grid;gap:6px"><span>URL</span><input id="fav-url" type="url" placeholder="Ex.: https://docs.google.com/spreadsheets/" style="padding:10px;border-radius:10px;border:1px solid #ccc;background:#fff;color:#111"/></label>
        <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:6px">
          <button type="button" class="menu-btn" data-close-fav>Cancelar</button>
          <button id="fav-save" type="button" class="menu-btn" style="background:#418d75;border-color:#418d75">Concluir</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal confirmação -->
  <div id="confirm-modal" class="menu-modal" aria-hidden="true">
    <div class="overlay-blur" data-confirm-cancel></div>
    <div class="menu-card" role="dialog" aria-modal="true" aria-labelledby="confirm-title">
      <div class="menu-header">
        <h2 id="confirm-title" class="menu-title">Confirmar ação</h2>
        <button class="menu-close" type="button" aria-label="Fechar" data-confirm-cancel>×</button>
      </div>
      <div style="display:grid;gap:12px;padding:10px 6px">
        <p id="confirm-message" style="opacity:.9"></p>
        <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:6px">
          <button type="button" class="menu-btn" data-confirm-cancel>Cancelar</button>
          <button type="button" class="menu-btn" id="confirm-ok" style="background:#d24b4b;border-color:#d24b4b">Remover</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Notice -->
  <div id="notice-overlay" class="notice-overlay" hidden></div>
  <div id="notice-modal" class="notice-modal" role="dialog" aria-modal="true" aria-labelledby="notice-title" aria-describedby="notice-desc" hidden>
    <button class="notice-close" aria-label="Fechar aviso" title="Fechar">
      <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path d="M18.3 5.71a1 1 0 0 0-1.41 0L12 10.59 7.11 5.7A1 1 0 0 0 5.7 7.11L10.59 12l-4.9 4.89a1 1 0 1 0 1.41 1.42L12 13.41l4.89 4.9a1 1 0 0 0 1.42-1.41L13.41 12l4.9-4.89a1 1 0 0 0-.01-1.4Z" fill="currentColor"/></svg>
    </button>
    <div class="notice-media"><img src="./../images/planodesaude-img.jpg" alt=""></div>
    <div class="notice-content">
      <h2 id="notice-title">Beneficios da Options</h2>
      <p id="notice-desc">Acesse os benefícios através da aba menu</p>
      <div class="notice-actions"><a href="./../beneficios" class="notice-cta">Saiba mais</a></div>
    </div>
  </div>
  
  <!-- START: Gemini Chat Widget -->
  <button id="chat-widget-button" aria-label="Abrir chat">
      <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"></path></svg>
  </button>
  <div id="chat-widget-container" class="hidden">
      <div class="chat-header">
          <div class="chat-header-title">
              <img src="./../images/logo.png" alt="Logo" class="chat-header-logo">
              <span>Options & Co. Chat</span>
          </div>
          <div class="chat-header-controls">
              <button id="chat-expand-btn" aria-label="Expandir chat">
                  <svg id="expand-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
              </button>
              <button id="chat-close-btn" aria-label="Fechar chat">&times;</button>
          </div>
      </div>
      <div class="chat-messages" id="chat-messages">
          <div class="chat-message model-message">Olá! Como posso ajudar você hoje?</div>
      </div>
      <form class="chat-form" id="chat-form">
          <input type="text" id="chat-input" placeholder="Digite sua mensagem..." autocomplete="off">
          <button id="chat-send-btn" type="submit" aria-label="Enviar mensagem">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
          </button>
      </form>
  </div>
  <!-- END: Gemini Chat Widget -->


  <!-- Firebase + Auth + Favoritos -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getAuth,onAuthStateChanged,setPersistence,browserLocalPersistence,signOut } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
    import { getRemoteConfig,fetchAndActivate,getValue } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-remote-config.js";
import { getFirestore,doc,getDoc,collection,query,where,getDocs,limit,addDoc,updateDoc,deleteDoc,onSnapshot,orderBy,serverTimestamp,runTransaction,setDoc } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
    const ready=new Promise(r=>{document.readyState.match(/complete|interactive/)?r():document.addEventListener("DOMContentLoaded",r,{once:true})});
    const wait=(sel,t=3e3)=>new Promise((res,rej)=>{const f=()=>document.querySelector(sel);if(f())return res(f());const m=new MutationObserver(()=>f()&&(m.disconnect(),res(f())));m.observe(document.documentElement,{childList:true,subtree:true});setTimeout(()=>{m.disconnect();rej(Error("Elemento não encontrado: "+sel))},t)});
    document.documentElement.classList.add("auth-checking");

    const cfg={apiKey:"AIzaSyDGyYza9iwZwc2k4yV9jNQqxa6sQxs-usI",authDomain:"login-intranet-96213.firebaseapp.com",projectId:"login-intranet-96213",storageBucket:"login-intranet-96213.firebasestorage.app",messagingSenderId:"492024716317",appId:"1:492024716317:web:17dd14c4b8decc8a86faf4",measurementId:"G-1KB77SBJ7L"};
    const app=initializeApp(cfg),auth=getAuth(app),db=getFirestore(app);
    const LOGIN_URL="./../login";
    await setPersistence(auth,browserLocalPersistence);

    const allow=()=>document.documentElement.classList.remove("auth-checking");
    const block=async()=>{try{await signOut(auth)}catch{};location.replace(LOGIN_URL)};
    const okEmail=e=>(e||"").toLowerCase().split("@").pop()?.trim()==="optionsco.com.br";

    const fetchNiceName=async u=>{
      const uid=u.uid,email=u.email||"";
      try{const s=await getDoc(doc(db,"users",uid)); if(s.exists()&&s.data()?.displayName)return String(s.data().displayName)}catch{}
      try{ if(email){const qs=await getDocs(query(collection(db,"users"),where("email","==",email),limit(1))); if(!qs.empty){const d=qs.docs[0].data(); if(d?.displayName)return String(d.displayName)}}}catch{}
      return u.displayName || (email?email.split("@")[0]:"Usuário");
    };

    const renderWelcome=async u=>{
      const el=document.getElementById("welcomeUser");
      try{let n=(await fetchNiceName(u))||""; n=String(n).replace(/^[“”"']+|[“”"']+$/g,"").replace(/\s+/g," ").trim(); el&&(el.textContent="Olá, "+n)}catch{el&&(el.textContent="Olá!")}
    };

    const ensureChips=()=>{
      let row=document.getElementById("quick-chip-row"); if(row) return row;
      const form=document.querySelector(".site-search"); if(!form||!form.parentElement) return null;
      const nav=document.createElement("nav"); nav.id="quick-shortcuts"; nav.className="quick-shortcuts"; nav.setAttribute("aria-label","Atalhos rápidos");
      row=document.createElement("div"); row.id="quick-chip-row"; row.className="chip-row"; row.setAttribute("role","list");
      nav.appendChild(row); form.parentElement.insertBefore(nav,form.nextSibling); return row;
    };

    const injectChipCSS=()=>{
      if(document.getElementById("quick-shortcuts-styles"))return;
      const css=`.quick-shortcuts{width:100%;max-width:640px;margin-top:10px}.chip-row{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;align-items:center;padding:4px;overflow-x:auto}.shortcut-chip{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;text-decoration:none;color:#fff;background:rgba(0,0,0,.28);border:1px solid rgba(255,255,255,.14);backdrop-filter:blur(4px);transition:background .2s,transform .06s,border-color .2s;white-space:nowrap}.shortcut-chip:hover{background:rgba(255,255,255,.1);border-color:rgba(255,255,255,.22)}.shortcut-chip:active{transform:translateY(1px)}.shortcut-chip img{width:18px;height:18px;border-radius:4px;display:block}.shortcut-add{font-weight:700;border-style:dashed;border-color:rgba(255,255,255,.22);cursor:pointer;background:transparent}@media (max-width:640px){.quick-shortcuts{max-width:90vw}}`;
      const s=document.createElement("style"); s.id="quick-shortcuts-styles"; s.textContent=css; document.head.appendChild(s);
    };

    const favIcon=u=>{try{const x=new URL(/^https?:\/\//i.test(u)?u:"https://"+u);return`https://www.google.com/s2/favicons?domain=${x.hostname}&sz=32`}catch{return"./../images/favicon_google.ico"}};
    const normUrl=u=>{u=(u||"").trim(); return u?(/^https?:\/\//i.test(u)?u:"https://"+u):""};

    const confirmPopup=({title="Confirmar ação",message="Tem certeza?",confirmText="OK"}={})=>new Promise(r=>{
      const modal=document.getElementById("confirm-modal"),t=modal.querySelector("#confirm-title"),m=modal.querySelector("#confirm-message"),ok=modal.querySelector("#confirm-ok"),c=modal.querySelectorAll("[data-confirm-cancel]");
      let last=document.activeElement;
      const close=v=>{modal.classList.remove("is-open");modal.setAttribute("aria-hidden","true");document.body.style.overflow="";document.removeEventListener("keydown",k);last?.focus?.();r(v)};
      const k=e=>{if(e.key==="Escape")close(false);if(e.key==="Enter")close(true)};
      t.textContent=title; m.textContent=message; ok.textContent=confirmText;
      modal.classList.add("is-open"); modal.setAttribute("aria-hidden","false"); document.body.style.overflow="hidden"; setTimeout(()=>ok?.focus?.(),0);
      document.addEventListener("keydown",k);
      ok.onclick=()=>close(true); c.forEach(el=>el.onclick=()=>close(false));
    });

    const bindFavModal=col=>{
      const modal=document.getElementById("fav-modal"),name=document.getElementById("fav-name"),url=document.getElementById("fav-url"),save=document.getElementById("fav-save");
      const open=()=>{modal.classList.add("is-open");modal.setAttribute("aria-hidden","false");name.value="";url.value="";setTimeout(()=>name?.focus?.(),0);document.body.style.overflow="hidden"};
      const close=()=>{modal.classList.remove("is-open");modal.setAttribute("aria-hidden","true");document.body.style.overflow=""};
      document.addEventListener("click",e=>{const b=e.target.closest("[data-open-fav-modal]"); if(b) open(); if(e.target.matches("[data-close-fav]")) close()});
      document.addEventListener("keydown",e=>{if(e.key==="Escape"&&modal.classList.contains("is-open")) close()});
      save?.addEventListener("click",async()=>{
        const n=name.value.trim(), u=normUrl(url.value);
        if(!n||!u) return alert("Preencha Nome e URL.");
        try{ await addDoc(col,{name:n,url:u,icon:favIcon(u),createdAt:serverTimestamp()}); close(); }catch{ alert("Não foi possível salvar o atalho."); }
      });
    };

    const initFavorites=u=>{
      const row=ensureChips(); injectChipCSS(); if(!row) return;
      const col=collection(db,"users",u.uid,"favorites"); bindFavModal(col);
      const chip=d=>{
        const a=document.createElement("a"); a.className="shortcut-chip"; a.href=d.url; a.target="_blank"; a.rel="noopener"; a.role="listitem"; a.style.position="relative";
        const img=new Image(); img.src=d.icon||favIcon(d.url); img.alt=""; img.referrerPolicy="no-referrer";
        const span=document.createElement("span"); span.textContent=d.name||d.url;
        const rm=document.createElement("button"); rm.type="button"; rm.title="Remover atalho"; rm.textContent="×"; rm.style.cssText="position:absolute;top:-6px;right:-6px;width:20px;height:20px;border-radius:50%;border:0;cursor:pointer;background:rgba(0,0,0,.55);color:#fff;display:grid;place-items:center;line-height:1";
        rm.addEventListener("click",async e=>{
          e.preventDefault(); e.stopPropagation();
          if(!await confirmPopup({title:"Remover atalho",message:`Remover "${d.name||d.url}"?`,confirmText:"Remover"})) return;
          try{ await deleteDoc(d._ref) }catch{ alert("Não foi possível remover o atalho.") }
        });
        a.append(img,span,rm); return a;
      };
      const addBtn=()=>{const b=document.createElement("button"); b.type="button"; b.className="shortcut-chip shortcut-add"; b.setAttribute("data-open-fav-modal",""); b.textContent="+ Atalho"; return b};
      const DEF=[{name:"Google",url:"https://www.google.com"},{name:"ChatGPT",url:"https://chatgpt.com"}];
      onSnapshot(query(col,orderBy("createdAt","asc")),snap=>{
        row.innerHTML="";
        const docs=snap.docs.map(x=>({id:x.id,...x.data(),_ref:x.ref}));
        (docs.length?docs:DEF.map(d=>({...d,icon:favIcon(d.url)}))).forEach(d=>row.appendChild(chip(d)));
        row.appendChild(addBtn());
      });
    };

const initNoticesPerUser = async (u) => {
  // --- Remote Config ---
  const rc = getRemoteConfig();
  rc.settings = { minimumFetchIntervalMillis: 60_000 };
  let arr = [];
  try {
    await fetchAndActivate(rc);
    const raw = getValue(rc, "notices").asString();
    try { arr = JSON.parse(raw); } catch { arr = []; }
  } catch { arr = []; }

  // Fallback: se não houver RC, usa 1 aviso fixo com seu conteúdo atual do HTML
  const modal    = document.getElementById("notice-modal");
  const overlay = document.getElementById("notice-overlay");
  const close   = modal?.querySelector(".notice-close");
  const imgEl   = modal?.querySelector(".notice-media img");
  const titleEl = modal?.querySelector("#notice-title");
  const descEl  = modal?.querySelector("#notice-desc");
  const ctaEl   = modal?.querySelector(".notice-cta");

  if (!modal || !overlay || !close || !imgEl || !titleEl || !descEl || !ctaEl) return;

  if (!Array.isArray(arr) || arr.length === 0) {
    arr = [{
      id: "default-v1",
      title: titleEl.textContent || "Aviso",
      desc:  descEl.textContent  || "",
      image: imgEl.getAttribute("src") || "",
      cta:   { label: ctaEl.textContent || "OK", url: ctaEl.getAttribute("href") || "#" }
    }];
  }

  // Forçar abertura para testes
  const force = new URL(location.href).searchParams.get("showNotice") === "1";

  // --- Firestore: doc onde marcamos o que já foi visto ---
  const seenRef = doc(db, "users", u.uid, "meta", "notice");
  let seen = {};
  try {
    const snap = await getDoc(seenRef);
    seen = snap.exists() ? (snap.data()?.seenVersions || {}) : {};
  } catch {}

  // Fila de avisos ainda não vistos
  const queue = arr.filter(n => force || !seen[n.id]).map(n => ({
    id: String(n.id || "").trim(),
    title: n.title || "",
    desc: n.desc || "",
    image: n.image || "",
    cta: { label: n?.cta?.label || "Saiba mais", url: n?.cta?.url || "#" }
  }));

  if (queue.length === 0) return;

  // Helpers UI
  const open = () => {
    overlay.hidden = false;
    modal.hidden = false;
    void modal.offsetWidth;
    modal.setAttribute("data-open", "true");
    close?.focus?.();
    document.documentElement.style.overflow = "hidden";
  };
  const hide = () => {
    modal.removeAttribute("data-open");
    setTimeout(() => {
      overlay.hidden = true;
      modal.hidden = true;
      document.documentElement.style.overflow = "";
    }, 200);
  };

  // Exibe um aviso, grava "visto" ao fechar, e chama o próximo
  const showNext = async () => {
    const n = queue.shift();
    if (!n) return;

    // Preenche conteúdo do modal
    if (n.title) titleEl.textContent = n.title;
    if (n.desc)  descEl.textContent  = n.desc;
    if (n.image) imgEl.src           = n.image;
    if (n.cta?.label) ctaEl.textContent = n.cta.label;
    if (n.cta?.url)   ctaEl.href        = n.cta.url;

    const dismiss = async () => {
      hide();
      try {
        // merge incremental do map seenVersions
        await setDoc(seenRef, { seenVersions: { [n.id]: serverTimestamp() } }, { merge: true });
        seen[n.id] = true;
      } catch {}
      // Próximo aviso (se houver)
      if (queue.length) {
        // pequena pausa para animação/UX
        setTimeout(showNext, 150);
      }
    };

    // Bind únicos por abertura
    const onKey = (e) => {
      if (!modal.hidden && (e.key === "Escape" || e.key === "Esc")) {
        e.preventDefault();
        cleanup();
        dismiss();
      }
    };
    const onClose = () => { cleanup(); dismiss(); };
    const onOverlay = () => { cleanup(); dismiss(); };

    const cleanup = () => {
      close.removeEventListener("click", onClose);
      overlay.removeEventListener("click", onOverlay);
      removeEventListener("keydown", onKey);
    };

    close.addEventListener("click", onClose, { once: true });
    overlay.addEventListener("click", onOverlay, { once: true });
    addEventListener("keydown", onKey);

    open();
  };

  showNext();
};



    onAuthStateChanged(auth,async u=>{
      try{
        if(!u||!okEmail(u.email)) return block();
        allow(); await ready; await wait(".site-search");
        await renderWelcome(u); initFavorites(u);
        await Promise.all([wait("#notice-modal"),wait("#notice-overlay")]);
        await initNoticesPerUser(u)
      }catch(e){ console.error("[auth state]",e); block(); }
    });
  </script>
  
  <!-- UI Scripts -->
  <script>
  (()=>{const $=s=>document.querySelector(s);
    const btn=$("#google-button"),dd=$("#google-dropdown");
    if(btn&&dd){const t=v=>{dd.classList.toggle("show",v);btn.setAttribute("aria-expanded",v?"true":"false");dd.setAttribute("aria-hidden",v?"false":"true")};
      btn.addEventListener("click",e=>{e.stopPropagation();t(!dd.classList.contains("show"))});
      document.addEventListener("click",e=>dd.classList.contains("show")&&!dd.contains(e.target)&&e.target!==btn&&t(false));
      document.addEventListener("keydown",e=>e.key==="Escape"&&t(false));
    }

    const openBtn=$("#menu-toggle"),modal=$("#menu-modal");
    if(openBtn&&modal){let last=null; const open=v=>{if(v){last=document.activeElement;modal.classList.add("is-open");modal.setAttribute("aria-hidden","false");document.body.style.overflow="hidden";setTimeout(()=>$("#menu-modal-title")?.focus?.(),0)}else{modal.classList.remove("is-open");modal.setAttribute("aria-hidden","true");document.body.style.overflow="";last?.focus?.();}};
      openBtn.addEventListener("click",e=>{e.preventDefault();open(true);openBtn.setAttribute("aria-expanded","true")});
      modal.addEventListener("click",e=>e.target.closest("[data-close-modal]")&&(open(false),openBtn.setAttribute("aria-expanded","false")));
      document.addEventListener("keydown",e=>e.key==="Escape"&&modal.classList.contains("is-open")&&(open(false),openBtn.setAttribute("aria-expanded","false")));
      modal.addEventListener("keydown",e=>{if(e.key!=="Tab")return;const f=[...modal.querySelectorAll('a[href],button:not([disabled]),textarea,input,select,[tabindex]:not([tabindex="-1"])')].filter(x=>x.offsetParent!==null);if(!f.length)return;const[first,last]=[f[0],f.at(-1)];if(e.shiftKey&&document.activeElement===first){e.preventDefault();last.focus()}else if(!e.shiftKey&&document.activeElement===last){e.preventDefault();first.focus()}});
      modal.querySelectorAll("[data-tab-target]").forEach(a=>a.addEventListener("click",e=>{e.preventDefault();const t=a.getAttribute("data-tab-target");t&&window.openTab&&window.openTab(t);open(false);openBtn.setAttribute("aria-expanded","false")}));
    }

    (()=>{const KEY="lastTab_v1",panels={home:$("#tab-home")},aria=(p,on)=>{const id=p?.getAttribute("aria-labelledby"); id&&document.getElementById(id)?.setAttribute("aria-current",on?"page":"false")};
      const activate=t=>{Object.keys(panels).forEach(k=>{const p=panels[k];p?.classList.toggle("active",k===t);aria(p,k===t)});try{localStorage.setItem(KEY,t)}catch{};};
      document.querySelectorAll("[data-tab-target]").forEach(a=>a.addEventListener("click",e=>{e.preventDefault();const t=a.getAttribute("data-tab-target");t&&panels[t]&&activate(t)}));
      const from=()=>{const h=(location.hash||"").replace("#","").toLowerCase(); if(h&&panels[h])return activate(h); try{const s=localStorage.getItem(KEY); if(s&&panels[s])return activate(s)}catch{} activate("home")};
      addEventListener("hashchange",()=>{const h=(location.hash||"").replace("#","").toLowerCase(); h&&panels[h]&&activate(h)});
      from(); window.openTab=activate;
    })();

    (()=>{const INPUT="#q",PANEL="#suggestions",FORM="#search-form",REC="recentSearches_v1",MAX=10,LIM=10;
      const $=s=>document.querySelector(s),norm=s=>(s||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase();
      const toks=q=>norm(q).split(/\s+/).filter(t=>t.length>=2), looks=t=>(t=t.trim(),/\./.test(t)&&!/\s/.test(t));
      const host=t=>{try{const u=/^https?:\/\//i.test(t)?t:"https://"+t; return new URL(u).hostname}catch{return null}};
      const icon=v=>{const h=host(v);return h?`https://www.google.com/s2/favicons?domain=${h}&sz=32`:""};
      const uniq=(a,k)=>{const s=new Set,o=[];for(const v of a){const kk=k(v);if(!s.has(kk)){s.add(kk);o.push(v)}}return o};
      const rec=()=>{try{return JSON.parse(localStorage.getItem(REC)||"[]")}catch{return[]}}, save=q=>{q=q.trim(); if(!q)return; let a=rec().filter(v=>v.toLowerCase()!==q.toLowerCase()); a.unshift(q); if(a.length>MAX)a=a.slice(0,MAX); localStorage.setItem(REC,JSON.stringify(a))}, rm=l=>localStorage.setItem(REC,JSON.stringify(rec().filter(v=>v.toLowerCase()!==(l||"").trim().toLowerCase())));
      const suggest=async q=>{if(!q)return[];try{const r=await fetch(`https://suggestqueries.google.com/complete/search?client=firefox&hl=pt-BR&q=${encodeURIComponent(q)}`,{mode:"cors"}); if(!r.ok)return[]; const d=await r.json(); return Array.isArray(d?.[1])?d[1]:[]}catch{return[]}};
      const item=(label,type="sugestao",o={})=>{const fill=o.fillValue||label,isUrl=looks(fill||label);return{label,subtitle:o.subtitleOverride??(isUrl?(fill||label).replace(/^https?:\/\//i,""):type==="atalho"?"Atalho":type==="recente"?"Recente":"Sugestão"),badge:type==="atalho"?"Atalho":type==="recente"?"Recente":"Sugestão",icon:o.iconOverride??(isUrl?icon(fill||label):"./../images/favicon_google.ico"),type,isUrl,fillValue:fill}};
      const SITES=[{name:"Google",domain:"google.com"},{name:"YouTube",domain:"youtube.com"},{name:"Facebook",domain:"facebook.com"},{name:"Instagram",domain:"instagram.com"},{name:"ChatGPT",domain:"chatgpt.com"},{name:"X",domain:"x.com"},{name:"Amazon",domain:"amazon.com"},{name:"LinkedIn",domain:"linkedin.com"},{name:"Netflix",domain:"netflix.com"},{name:"Gemini",domain:"gemini.google.com"},{name:"InfoMoney",domain:"infomoney.com.br"},{name:"CNN",domain:"cnn.com"},{name:"Looker Studio",domain:"lookerstudio.google.com"},{name:"Google Sheets",domain:"sheets.google.com"},{name:"WhatsApp Web",domain:"web.whatsapp.com"},{name:"Formulários Google",domain:"forms.google.com"},{name:"Canva",domain:"canva.com"},{name:"Wikipedia",domain:"wikipedia.org"},{name:"Pinterest",domain:"pinterest.com"},{name:"Globo",domain:"globo.com"},{name:"Telegram",domain:"t.me"},{name:"The New York Times",domain:"nytimes.com"},{name:"AliExpress",domain:"aliexpress.com"},{name:"Discord",domain:"discord.com"},{name:"BBC",domain:"bbc.com"},{name:"Speedtest by Ookla",domain:"speedtest.net"},{name:"Gmail",domain:"mail.google.com"},{name:"Google Drive",domain:"drive.google.com"},{name:"Google Docs",domain:"docs.google.com"},{name:"Google Slides",domain:"slides.google.com"},{name:"Google Keep",domain:"keep.google.com"},{name:"Google Calendar",domain:"calendar.google.com"},{name:"Google Meet",domain:"meet.google.com"},{name:"Google Chat",domain:"chat.google.com"},{name:"Google Maps",domain:"maps.google.com"},{name:"Google Earth",domain:"earth.google.com"},{name:"Google Translate",domain:"translate.google.com"},{name:"Google Photos",domain:"photos.google.com"},{name:"Google News",domain:"news.google.com"},{name:"Google Finance",domain:"google.com/finance"},{name:"Google Flights",domain:"google.com/flights"},{name:"Google Books",domain:"books.google.com"},{name:"Google Play",domain:"play.google.com"},{name:"Google Colab",domain:"colab.research.google.com"},{name:"Spotify",domain:"spotify.com"},{name:"YouTube Music",domain:"music.youtube.com"},{name:"Tryd",domain:"tryd.com.br"},{name:"Fast trade",domain:"plataformafasttrade.com.br"},{name:"Chat Guru",domain:"chatguru.com.br"},{name:"Brasil Jornal",domain:"braziljournal.com"},{name:"Flex Scan",domain:"login.flexscan.com.br"},{name:"Git Hub",domain:"github.com"}];
      const std=q=>!q?[]:SITES.filter(s=>{const n=norm(s.name),d=norm(s.domain),S=norm(q);return S.length===1?n.startsWith(S):toks(q).every(t=>(n+" "+d).includes(t))}).map(s=>item(s.name,"atalho",{subtitleOverride:s.domain,iconOverride:icon(s.domain),fillValue:s.domain}));
      const m=(x,q)=>{const s=norm(q||""); if(!s)return false; const base=norm(`${x.fillValue||x.label} ${x.subtitle||""}`); if(s.length===1){const dom=norm((x.subtitle||"").split(" — ")[0]||""); return base.startsWith(s)||dom.startsWith(s)} return s.split(/\s+/).every(t=>base.includes(t))};
      const p=()=>$ (PANEL), apply=x=>{const i=$(INPUT); if(!i)return; i.value=x.fillValue||x.label; i.setSelectionRange(i.value.length,i.value.length); hide()}, hide=()=>{const y=p(); y&&(y.hidden=true)};
      const el=(x,i,rem=false)=>{const d=document.createElement("div"); d.className="suggest-item"; d.setAttribute("role","option"); d.dataset.index=i;
        const ic=new Image(); ic.className="suggest-icon"; ic.alt=""; ic.referrerPolicy="no-referrer"; x.icon?ic.src=x.icon:ic.style.visibility="hidden";
        const t=document.createElement("div"); t.className="suggest-text"; const a=document.createElement("div"); a.className="suggest-primary"; a.textContent=x.label; const b=document.createElement("div"); b.className="suggest-secondary"; b.textContent=x.subtitle; t.append(a,b);
        const badge=document.createElement("div"); badge.className="suggest-badge"; badge.textContent=x.badge;
        d.append(ic,t,badge);
        if(rem){const r=document.createElement("div"); r.className="suggest-remove"; r.textContent="×"; r.addEventListener("mousedown",e=>e.preventDefault()); r.addEventListener("click",e=>{e.stopPropagation(); rm(x.fillValue||x.label); d.remove(); if(!p()?.querySelector(".suggest-item")){const y=p(); if(!y)return; y.innerHTML=""; const z=document.createElement("div"); z.className="suggest-empty"; z.textContent="Sem sugestões"; y.appendChild(z)}}); d.appendChild(r)}
        d.addEventListener("mousedown",e=>e.preventDefault()); d.addEventListener("click",()=>apply(x));
        return d;
      };
      const render=(xs,a=-1)=>{const y=p(); if(!y)return; y.innerHTML=""; if(!xs.length){y.hidden=false; const d=document.createElement("div"); d.className="suggest-empty"; d.textContent="Sem sugestões"; y.appendChild(d); return} xs.slice(0,LIM).forEach((x,i)=>{const e=el(x,i,x.type==="recente"); if(i===a)e.setAttribute("aria-selected","true"); y.appendChild(e)}); y.hidden=false};
      let sup=false, active=-1, cur=[];
      const should=i=>i.selectionStart!==i.selectionEnd||i.selectionStart!==i.value.length;
      const inline=(typed,xs,kb=false)=>{const i=$(INPUT); if(!i||!typed||kb||sup||should(i))return; const c=xs.find(x=>(x.fillValue||x.label).toLowerCase().startsWith(typed.toLowerCase())); if(!c)return; const v=c.fillValue||c.label; i.value=v; try{i.setSelectionRange(typed.length,v.length)}catch{}};
      const deb=(fn,ms=120)=>{let id; return(...a)=>{clearTimeout(id); id=setTimeout(()=>fn(...a),ms)}};
      const SHORT=[{re:/^y(t|o|outube)?$/i,items:["YouTube","youtube.com"]},{re:/^g(mail)?$/i,items:["Gmail","mail.google.com"]},{re:/^c(al|alendar)?$/i,items:["Google Calendar","calendar.google.com"]},{re:/^m(eet)?$/i,items:["Google Meet","meet.google.com"]},{re:/^(d|drive)$/i,items:["Google Drive","drive.google.com"]},{re:/^(s|sheets?)$/i,items:["Google Sheets","docs.google.com/spreadsheets/"]}];
      const applyShort=q=>SHORT.find(s=>s.re.test(q))?.items??[];
      const refresh=async(kb=false,ev=null)=>{const i=$(INPUT),q=(i?.value||"").trim(); if(ev?.startsWith?.("delete")||ev?.inputType?.startsWith?.("delete")) sup=true; if(ev?.ctrlKey||ev?.metaKey||ev?.altKey) sup=true;
        const stds=std(q), r=rec(), sh=applyShort(q), remote=q?await suggest(q):[];
        const pool=q?[...new Set([...sh,...remote,...r])]:[];
        let other=pool.map(s=>item(s,sh.includes(s)?"atalho":r.includes(s)?"recente":"sugestao")).filter(x=>m(x,q));
        if(q&&looks(q)&&!other.concat(stds).some(x=>(x.fillValue||x.label).toLowerCase()===q.toLowerCase())) other.unshift(item(q,"sugestao"));
        cur=uniq([...stds,...other], x=>(x.fillValue||x.label).toLowerCase()); active=-1; q?(render(cur,active),inline(q,cur,kb)):hide(); sup=false;
      };
      const debounced=deb(refresh,120);
      const keys=e=>{const y=p(),i=$(INPUT); if(e.key==="Backspace"||e.key==="Delete")sup=true; if(e.ctrlKey||e.metaKey||e.altKey)sup=true; if(!y||y.hidden)return;
        const max=Math.min(LIM,cur.length)-1;
        if(e.key==="ArrowDown"||e.key==="ArrowUp"){e.preventDefault(); active=e.key==="ArrowDown"?(active<max?active+1:0):(active>0?active-1:max); render(cur,active); const m=cur[active]; if(m){const v=m.fillValue||m.label; i.value=v; i.setSelectionRange(v.length,v.length)}}
        else if(e.key==="Tab"){ if(i.selectionStart!==i.selectionEnd&&cur.length){e.preventDefault(); i.setSelectionRange(i.value.length,i.value.length); hide()} }
        else if(e.key==="Enter"||e.key==="Escape") hide();
      };
      const submit=e=>{const i=$(INPUT),q=(i?.value||"").trim(); if(!q){e.preventDefault();return} save(q); if(looks(q)){e.preventDefault(); location.assign(/^https?:\/\//i.test(q)?q:"https://"+q)}};
      const focus=()=>{const i=$(INPUT); if(!i)return; if(document.visibilityState!=="visible"){document.addEventListener("visibilitychange",focus,{once:true}); return} i.focus({preventScroll:true}); try{i.select()}catch{}};
      const retries=(r=24,d=50)=>{focus(); let c=1; const id=setInterval(()=>{const ok=document.activeElement?.matches?.(INPUT); if(ok||c++>=r)clearInterval(id); else focus()},d)};
      addEventListener("keydown",e=>{if(/input|textarea|select/i.test(e.target.tagName))return; if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="k"){e.preventDefault();retries(1,0)} else if(!e.ctrlKey&&!e.metaKey&&!e.altKey&&e.key==="/"){e.preventDefault();retries(1,0)}});
      addEventListener("click",e=>{const y=p(),i=$(INPUT); if(!y||y.hidden)return; if(!y.contains(e.target)&&e.target!==i) hide()});

      document.addEventListener("DOMContentLoaded",()=>{const i=$(INPUT),y=p(),f=$(FORM); if(!i||!y||!f)return; retries();
        let allow=false; i.addEventListener("pointerdown",()=>allow=true);
        i.addEventListener("focus",()=>{ if(!allow||i.value.trim())return; const r=rec().map(s=>item(s,"recente")); if(!r.length)return; y.innerHTML=""; r.slice(0,LIM).forEach((x,j)=>y.appendChild(el(x,j,true))); y.hidden=false; });
        i.addEventListener("input",ev=>debounced(false,ev)); i.addEventListener("keydown",keys); i.addEventListener("blur",()=>setTimeout(hide,100)); f.addEventListener("submit",submit);
      });
    })();
  })();

/* [    {      "id": "2025-10-campanha-a-v1",      "title": "Primeiro aviso",      "desc": "Texto do aviso A.",      "image": "images/academia-img.png",      "cta": { "label": "Saiba mais", "url": "https://exemplo.com/a" }    },    {      "id": "2025-10-campanha-b-v2",      "title": "Segundo aviso",      "desc": "Texto do aviso B.",      "image": "images/academia-img.png",      "cta": { "label": "Abrir", "url": "https://exemplo.com/b" }    },    {      "id": "2025-10-campanha-c-v3",      "title": "Aviso 3",      "desc": "Texto do aviso C.",      "image": "images/academia-img.png",      "cta": { "label": "Detalhes", "url": "https://exemplo.com/c" }    } ]
 */ 
  </script>
  
  <!-- START: Gemini Chat Logic -->
 <script>
    document.addEventListener('DOMContentLoaded', () => {
        const chatButton = document.getElementById('chat-widget-button');
        const chatContainer = document.getElementById('chat-widget-container');
        const closeButton = document.getElementById('chat-close-btn');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const messagesContainer = document.getElementById('chat-messages');
        const expandButton = document.getElementById('chat-expand-btn');
        const expandIcon = document.getElementById('expand-icon');

        const minimizeIconSvg = `<path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/>`;
        const expandIconSvg = `<path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>`;

        const toggleChat = (forceOpen = null) => {
            const isHidden = chatContainer.classList.contains('hidden');
            if (forceOpen === true || isHidden) {
                chatContainer.classList.remove('hidden');
                chatButton.classList.add('hidden');
            } else if (forceOpen === false || !isHidden) {
                chatContainer.classList.add('hidden');
                chatButton.classList.remove('hidden');
            }
        };

        chatButton.addEventListener('click', () => toggleChat(true));
        closeButton.addEventListener('click', () => toggleChat(false));

        expandButton.addEventListener('click', () => {
            chatContainer.classList.toggle('expanded');
            const isExpanded = chatContainer.classList.contains('expanded');
            expandIcon.innerHTML = isExpanded ? minimizeIconSvg : expandIconSvg;
        });

        const addMessage = (text, sender) => {
            const messageElement = document.createElement('div');
            messageElement.classList.add('chat-message', `${sender}-message`);
            messageElement.textContent = text;
            messagesContainer.appeWndChild(messageElement);
            scrollToBottom();
            return messageElement;
        };
        
        const showLoading = () => {
            const loadingElement = document.createElement('div');
            loadingElement.classList.add('chat-message', 'model-message', 'loading-indicator');
            loadingElement.innerHTML = '<span></span><span></span><span></span>';
            messagesContainer.appendChild(loadingElement);
            scrollToBottom();
            return loadingElement;
        };

        const scrollToBottom = () => {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        };

        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userInput = chatInput.value.trim();
            if (!userInput) return;

            addMessage(userInput, 'user');
            chatInput.value = '';
            const loadingElement = showLoading();

            try {
                const modelResponse = await callGeminiAPI(userInput);
                loadingElement.remove();
                addMessage(modelResponse, 'model');
            } catch (error) {
                loadingElement.remove();
                addMessage('Desculpe, não consegui obter uma resposta. Tente novamente.', 'model');
            }
        });

        async function callGeminiAPI(prompt) {
            // A API Key é deixada em branco para ser gerenciada pelo ambiente de execução.
            const apiKey = "AIzaSyAp_S0yKJCsz4Fu1ce02rIw1X01OzfeZzo"; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            
            // Define o comportamento do assistente: amigável, baseado no site e prestativo.
            const systemPrompt = "Seu papel é ser um assistente virtual prestativo e amigável da Options & Company. Responda de forma conversacional, baseando seu conhecimento nas informações do site oficial, optionsco.com.br. Se não encontrar uma resposta, explique que sua fonte é o site e que não localizou a informação, mas se mostre disposto a ajudar de outra maneira.";

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
                // Habilita a ferramenta de busca do Google para encontrar informações no site
                tools: [{ "google_search": {} }]
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorBody = await response.json();
                    console.error("API Error:", errorBody);
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.candidates && data.candidates.length > 0 && data.candidates[0].content.parts.length > 0) {
                    return data.candidates[0].content.parts[0].text;
                } else {
                    return "Não obtive uma resposta válida.";
                }

            } catch (error) {
                console.error("Erro ao chamar a API do Gemini:", error);
                throw error;
            }
        }
    });
 </script>
 <!-- END: Gemini Chat Logic -->

</body>

</html>
